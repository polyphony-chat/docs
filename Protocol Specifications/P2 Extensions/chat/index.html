
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.polyphony.chat/Protocol%20Specifications/P2%20Extensions/chat/">
      
      
        <link rel="prev" href="../auth/">
      
      
        <link rel="next" href="../mls/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../assets/polyproto-glow.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>polyproto-chat - Polyphony</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#p2-extension-polyproto-chat" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Polyphony" class="md-header__button md-logo" aria-label="Polyphony" data-md-component="logo">
      
  <img src="../../../assets/polyproto-bichrome.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Polyphony
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              polyproto-chat
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/polyphony-chat/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Overviews/core/" class="md-tabs__link">
          
  
  
    
  
  Overviews

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../core/" class="md-tabs__link">
          
  
  
    
  
  Protocol Specifications

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../assets/external/unpkg.com/mathjax%403/es5/output/chtml/fonts/woff-v2/" class="md-tabs__link">
          
  
  
    
  
  Assets

        </a>
      </li>
    
  

    
  

    
  

    
  

    
  

    
  

    
  

    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../APIs/" class="md-tabs__link">
          
  
  
    
  
  APIs

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Type%20Definitions/" class="md-tabs__link">
          
  
  
    
  
  Type Definitions

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Polyphony" class="md-nav__button md-logo" aria-label="Polyphony" data-md-component="logo">
      
  <img src="../../../assets/polyproto-bichrome.svg" alt="logo">

    </a>
    Polyphony
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/polyphony-chat/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../blog/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    February 2025
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    October 2024
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    November 2023
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/x509/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/chorus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    chorus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/polyphony/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polyphony
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/polyproto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polyproto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/updates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    updates
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Overviews
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Overviews
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Overviews/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    An Overview of polyproto
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Protocol Specifications
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Protocol Specifications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polyproto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    P2 Extensions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            P2 Extensions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polyproto-auth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    polyproto-chat
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    polyproto-chat
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-trust-model" class="md-nav__link">
    <span class="md-ellipsis">
      1. Trust model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-federation-principles" class="md-nav__link">
    <span class="md-ellipsis">
      2. Federation Principles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#21-messaging-groups" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Messaging Groups
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 Messaging Groups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-private-messages" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.1 Private messages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-group-messages" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.2 Group messages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22-guilds-and-guild-channels" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Guilds and Guild channels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-general-behaviors" class="md-nav__link">
    <span class="md-ellipsis">
      3. General Behaviors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#31-joining-a-foreign-guild" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Joining a foreign guild
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-gateway" class="md-nav__link">
    <span class="md-ellipsis">
      4. Gateway
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      5. Data Structures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      6. Permissions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-rate-limits" class="md-nav__link">
    <span class="md-ellipsis">
      7. Rate Limits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-voice-and-video" class="md-nav__link">
    <span class="md-ellipsis">
      8. Voice and Video
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      9. Encryption
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-push-notifications" class="md-nav__link">
    <span class="md-ellipsis">
      10. Push Notifications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-moderation-and-administration" class="md-nav__link">
    <span class="md-ellipsis">
      11. Moderation and Administration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polyproto-chat-specific-glossary" class="md-nav__link">
    <span class="md-ellipsis">
      polyproto-chat specific glossary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-glossary" class="md-nav__link">
    <span class="md-ellipsis">
      General glossary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polyproto-mls
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Assets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Assets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    External
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            External
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Unpkg.com
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            Unpkg.com
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_1" id="__nav_5_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Mathjax@3
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Mathjax@3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_1_1" id="__nav_5_1_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Es5
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Es5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_1_1_1" id="__nav_5_1_1_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Output
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_1_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Output
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_1_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_1_1_1_1" id="__nav_5_1_1_1_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chtml
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_5_1_1_1_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Chtml
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_1_1_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_1_1_1_1_1_1" id="__nav_5_1_1_1_1_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fonts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="8" aria-labelledby="__nav_5_1_1_1_1_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Fonts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1_1_1_1_1_1_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../assets/external/unpkg.com/mathjax%403/es5/output/chtml/fonts/woff-v2/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Woff v2
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_5_1_1_1_1_1_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_1_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Woff v2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../APIs/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    APIs
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../APIs/auth/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Auth
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Auth
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../APIs/auth/Routes%3A%20Registration%20needed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authentication Routes: Registration needed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../APIs/auth/Routes%3A%20No%20registration%20needed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authentication Routes: No registration needed
    
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../APIs/MLS/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    MLS
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            MLS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../APIs/MLS/Routes%3A%20Registration%20needed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MLS Routes: Registration needed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../APIs/MLS/Routes%3A%20No%20registration%20needed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MLS Routes: No registration needed
    
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Type%20Definitions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Type Definitions
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Type Definitions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Type%20Definitions/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polyproto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Type%20Definitions/auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    polyproto-auth
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-trust-model" class="md-nav__link">
    <span class="md-ellipsis">
      1. Trust model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-federation-principles" class="md-nav__link">
    <span class="md-ellipsis">
      2. Federation Principles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#21-messaging-groups" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Messaging Groups
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 Messaging Groups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-private-messages" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.1 Private messages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-group-messages" class="md-nav__link">
    <span class="md-ellipsis">
      2.1.2 Group messages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22-guilds-and-guild-channels" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Guilds and Guild channels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-general-behaviors" class="md-nav__link">
    <span class="md-ellipsis">
      3. General Behaviors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#31-joining-a-foreign-guild" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Joining a foreign guild
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-gateway" class="md-nav__link">
    <span class="md-ellipsis">
      4. Gateway
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      5. Data Structures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      6. Permissions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-rate-limits" class="md-nav__link">
    <span class="md-ellipsis">
      7. Rate Limits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-voice-and-video" class="md-nav__link">
    <span class="md-ellipsis">
      8. Voice and Video
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      9. Encryption
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-push-notifications" class="md-nav__link">
    <span class="md-ellipsis">
      10. Push Notifications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-moderation-and-administration" class="md-nav__link">
    <span class="md-ellipsis">
      11. Moderation and Administration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polyproto-chat-specific-glossary" class="md-nav__link">
    <span class="md-ellipsis">
      polyproto-chat specific glossary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-glossary" class="md-nav__link">
    <span class="md-ellipsis">
      General glossary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="p2-extension-polyproto-chat">p2-Extension: polyproto-chat<a class="headerlink" href="#p2-extension-polyproto-chat" title="Permanent link">&para;</a></h1>
<ul>
<li>Namespace: <code>chat</code></li>
<li>Version: <code>v0.1.0-alpha.1</code></li>
<li>API version: <code>v0.1.0-alpha.1</code></li>
<li>API documentation: <a href="https://apidocs.polyproto.org">apidocs.polyproto.org</a></li>
<li>Dependencies:<ul>
<li><a href="https://docs.polyphony.chat/Protocol%20Specifications/core/">polyproto</a>@1.0.0-beta.1</li>
<li><a href="https://docs.polyphony.chat/Protocol%20Specifications/P2%20Extensions/mls/">mls</a>@0.1.0-alpha.1</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The polyproto-chat specification document is in an <strong>alpha</strong> phase. Please report any inconsistencies,
missing or duplicate information and other mistakes at <a href="https://github.com/polyphony-chat/docs/issues">github.com/polyphony-chat/docs/issues</a>.</p>
</div>
<p><a href="https://semver.org/spec/v2.0.0.html">Semantic versioning v2.0.0</a> is used to version this specification.</p>
<ul>
<li><a href="#p2-extension-polyproto-chat">p2-Extension: polyproto-chat</a></li>
<li><a href="#1-trust-model">1. Trust model</a></li>
<li><a href="#2-federation-principles">2. Federation Principles</a></li>
<li><a href="#21-messaging-groups">2.1 Messaging Groups</a><ul>
<li><a href="#211-private-messages">2.1.1 Private messages</a></li>
<li><a href="#212-group-messages">2.1.2 Group messages</a></li>
</ul>
</li>
<li><a href="#22-guilds-and-guild-channels">2.2 Guilds and Guild channels</a></li>
<li><a href="#3-general-behaviors">3. General Behaviors</a></li>
<li><a href="#31-joining-a-foreign-guild">3.1 Joining a foreign guild</a></li>
<li><a href="#4-gateway">4. Gateway</a></li>
<li><a href="#5-data-structures">5. Data Structures</a></li>
<li><a href="#6-permissions">6. Permissions</a></li>
<li><a href="#7-rate-limits">7. Rate Limits</a></li>
<li><a href="#8-voice-and-video">8. Voice and Video</a></li>
<li><a href="#9-encryption">9. Encryption</a></li>
<li><a href="#10-push-notifications">10. Push Notifications</a></li>
<li><a href="#11-moderation-and-administration">11. Moderation and Administration</a></li>
<li><a href="#polyproto-chat-specific-glossary">polyproto-chat specific glossary</a></li>
<li><a href="#general-glossary">General glossary</a></li>
</ul>
<h2 id="1-trust-model">1. Trust model<a class="headerlink" href="#1-trust-model" title="Permanent link">&para;</a></h2>
<p>polyproto-chat inherits its trust model from the core polyproto specification. In addition, the
following trust assumptions are added:</p>
<ol>
<li>Unencrypted messages can only be read by users with the necessary permissions to access the channel
   the message was sent to, at the point the message was sent, or in the future. In addition,
   server moderators, -administrators and other entities who can access the infrastructure the
   server is hosted on are always able to read unencrypted messages, whether through directly
   accessing this information or because of a report that was filed by another user.</li>
<li>Unencrypted metadata can be accessed by the same set of people described in 1.</li>
<li>Server moderators, -administrators, other entities who may gain access to the infrastructure the
   server is hosted on and other polyproto-chat users can not read encrypted messages or -metadata in
   plain text, if they are not themselves part of the MLS group the message was sent in.</li>
<li>Extending 3., server moderators, -administrators and other entities have <strong>no way</strong> to gain insight
   into the contents of an encrypted message, if they are not themselves part of the MLS group the
   message was sent in.</li>
<li>Compromise of an encrypted communications channel will not expose past communications.</li>
<li>After an encrypted communications channel has been compromised, it is possible to re-establish
   the security/secrecy guarantees (post-compromise security).</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Human error, faulty software or malicious actions can always lead to unauthorized access to
information, encrypted or not. This is true for every user-facing application employing encryption
<em>ever</em>, not just polyproto-chat.</p>
</div>
<h2 id="2-federation-principles">2. Federation Principles<a class="headerlink" href="#2-federation-principles" title="Permanent link">&para;</a></h2>
<p>This section explains how the federation in different parts of polyproto-chat works.</p>
<h2 id="21-messaging-groups">2.1 Messaging Groups<a class="headerlink" href="#21-messaging-groups" title="Permanent link">&para;</a></h2>
<p>Every messaging group is also an MLS group. Messaging groups are always encrypted using the MLS
protocol and shared cipher suites. A direct messaging group between two actors is also treated as
a group message in this case.</p>
<p>Group messages are decentralized in nature. Each participant of a messaging group stores the messages
they send on the server which acts as their primary service provider for the polyproto-chat service.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Read chapter #9 of the polyproto core specification document for more information on services and
service providers.</p>
</div>
<p>With multiple servers participating in a conversation, a server outage only affects the messages
stored on that server, not the entire messaging group.</p>
<h3 id="211-private-messages">2.1.1 Private messages<a class="headerlink" href="#211-private-messages" title="Permanent link">&para;</a></h3>
<p>The below sequence diagram showcases how a private messaging channel between two actors with different
service providers works.</p>
<pre class="mermaid"><code>sequenceDiagram
autonumber

actor a as Alice
participant s1 as Server A
participant s2 as Server B
actor b as Bob

a-&gt;&gt;a: Encrypt message for MLS group
a-&gt;&gt;s1: Send encrypted message&lt;br/&gt;to own server
s1-&gt;s1: Store encrypted message
s1-&gt;&gt;s2: Forward encrypted message&lt;br/&gt;to Bobs home server
note over s2: Server B does not store&lt;br/&gt;the encrypted message.
s2-&gt;&gt;b: Forward message&lt;br/&gt;to Bob
opt Bob sends a message
  b-&gt;&gt;b: Encrypt message for MLS group
  b-&gt;&gt;s2: Send encrypted message&lt;br/&gt;to own server
  s2-&gt;s2: Store encrypted message
  s2-&gt;&gt;s1: Forward encrypted message&lt;br/&gt;to Alices home server
  note over s1: Server A does not store&lt;br/&gt;the encrypted message.
s1-&gt;&gt;a: Forward message&lt;br/&gt;to Alice
end
opt Bob wants to fetch the message at a later point
  note over b,s1: Bob must be authenticated on Server A and&lt;br/&gt;must present a valid session token to fetch messages.
  b-&gt;&gt;s1: Request message with $id
  s1-&gt;s1: Load message
  s1-&gt;&gt;b: Retrieved message
end
opt Alice wants to fetch her message at a later point
  note over a,s1: Of course, Alice must also present a&lt;br/&gt;valid session token to fetch messages.
  a-&gt;&gt;s1: Request message with $id
  s1-&gt;s1: Load message
  s1-&gt;&gt;a: Retrieved message
end</code></pre>
<p><em>Fig. 1: Message sending and message retrieval in a private messaging group.</em></p>
<p>If the actors use the same primary service provider for the <code>chat</code> service, steps (4) and (9) do
not apply.</p>
<h3 id="212-group-messages">2.1.2 Group messages<a class="headerlink" href="#212-group-messages" title="Permanent link">&para;</a></h3>
<p>Below, you can find a condensed sequence diagram showcasing how a messaging group with &gt; 2 actors
works:</p>
<pre class="mermaid"><code>sequenceDiagram
autonumber

actor a as Actor 1
participant s1 as Server 1
participant s2 as Server 2
participant s3 as Server n
actor b as Actor 2
actor c as Actor m

a-&gt;&gt;a: Encrypt message for MLS group
a-&gt;&gt;s1: Send encrypted message&lt;br/&gt;to own server
s1-&gt;s1: Store encrypted message
note over s1,s3: It is the senders' servers' duty to forward&lt;br/&gt;this message to all other involved servers.
par
  s1-&gt;&gt;s2: Forward message to Server 2
and
  s1-&gt;&gt;s3: Forward message to Server n
end
note over s2,s3: Neither of these servers store&lt;br/&gt;this message.
par
s2-&gt;&gt;b: Forward message&lt;br/&gt;to Actor 2
and
s3-&gt;&gt;c: Forward message&lt;br/&gt;to Actor m
end
note over a,c: Fetching messages works the same way as showcased in Fig. 1.</code></pre>
<p><em>Fig. 2: Message sending and message retrieval in a messaging group.</em></p>
<p>If two actors have the same primary service provider for the <code>chat</code> service, steps facilitating
communication across servers do not apply.</p>
<h2 id="22-guilds-and-guild-channels">2.2 Guilds and Guild channels<a class="headerlink" href="#22-guilds-and-guild-channels" title="Permanent link">&para;</a></h2>
<p>Unlike messaging groups, guild channels are not encrypted by default.</p>
<div class="admonition question">
<p class="admonition-title">Why are guild channels not encrypted by default?</p>
<p>In the real world, most guilds are used as spaces for open communities where people join and leave
freely. Encrypted communications channels are useful when the communication between actors is potentially
sensitive. Additionally, for encryption to be effective, you must at least somewhat trust the
parties able to decrypt your messages.</p>
<p>The potential for anyone to join a chat and receive the entire encrypted history undermines the
purpose of encryption. Therefore, we don't offer cross-actor encrypted chat history distribution,
even for guild channels.</p>
<p>Encrypted guild channels are available, but without cross-actor encrypted chat history
distribution, their user experience is not fit for a "default" status.</p>
</div>
<p>All messages sent to guild channels are stored on the server that hosts the guild.</p>
<pre class="mermaid"><code>sequenceDiagram
autoNumber

actor a as Alice
participant s as Guild Server
actor b as Bob

a-&gt;&gt;s: Send message
note over s: The server distributes the message to all&lt;br/&gt;recipients.
par
  s-&gt;&gt;a: MESSAGE_CREATE
and
  s-&gt;&gt;b: MESSAGE_CREATE
end</code></pre>
<h2 id="3-general-behaviors">3. General Behaviors<a class="headerlink" href="#3-general-behaviors" title="Permanent link">&para;</a></h2>
<p>This chapter covers general behaviors, describing how a polyproto-chat server or client is expected to
behave.</p>
<h2 id="31-joining-a-foreign-guild">3.1 Joining a foreign guild<a class="headerlink" href="#31-joining-a-foreign-guild" title="Permanent link">&para;</a></h2>
<p>...</p>
<h2 id="4-gateway">4. Gateway<a class="headerlink" href="#4-gateway" title="Permanent link">&para;</a></h2>
<p>This chapter covers polyproto-chat specific gateway events, opcodes and more.</p>
<h2 id="5-data-structures">5. Data Structures<a class="headerlink" href="#5-data-structures" title="Permanent link">&para;</a></h2>
<p>This chapter defines all data structures found in polyproto-chat.</p>
<h2 id="6-permissions">6. Permissions<a class="headerlink" href="#6-permissions" title="Permanent link">&para;</a></h2>
<p>This chapter describes the permission system of polyproto-chat, defining the actions and resources
actors can access.</p>
<h2 id="7-rate-limits">7. Rate Limits<a class="headerlink" href="#7-rate-limits" title="Permanent link">&para;</a></h2>
<p>This chapter defines the rate limiting system used in polyproto-chat.</p>
<h2 id="8-voice-and-video">8. Voice and Video<a class="headerlink" href="#8-voice-and-video" title="Permanent link">&para;</a></h2>
<p>This section covers voice and video encoding, decoding and transmission.</p>
<h2 id="9-encryption">9. Encryption<a class="headerlink" href="#9-encryption" title="Permanent link">&para;</a></h2>
<p>This chapter defines cryptographic behaviors, routines and defaults which polyproto-chat implementations
must implement.</p>
<h2 id="10-push-notifications">10. Push Notifications<a class="headerlink" href="#10-push-notifications" title="Permanent link">&para;</a></h2>
<p>This chapter covers how push notifications work in polyproto-chat.</p>
<h2 id="11-moderation-and-administration">11. Moderation and Administration<a class="headerlink" href="#11-moderation-and-administration" title="Permanent link">&para;</a></h2>
<p>This chapter talks about moderation and administration of a p2-chat server.</p>
<hr />
<p><em>Fig. 3: Sequence diagram, showing Alice sending a message to a guild channel accessible to both
Alice and Bob.</em></p>
<div class="admonition bug">
<p class="admonition-title">Legacy</p>
<p>The below "fenced" text is considered out-of-date. Useful information will be migrated soon, though
most of the information is deprecated.</p>
</div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>## 3. Encrypted channels and groups
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Note, that in the below sequence diagrams, the MLS Welcome message and the MLS Group notify
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>message are all encrypted using the identity key of the recipient.
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>### 3.1 Encrypted guild channels
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>Encrypting a guild channel is done by a client with the `MANAGE_CHANNEL` permission. Upon
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>successfully requesting enabling encryption of a channel, all future messages in it will be
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>encrypted. Joining an encrypted channel is done by sending a join request to the server. The server
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>will then notify the channels&#39; members of the join request. The members will then decide whether to
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>accept or reject the join request. If the join request is accepted by any member, that member will
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>initiate the MLS welcoming process. If the member finds that the join request is invalid (perhaps
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>due to an invalid `KeyPackage`), the join request must be denied. It is imperative that join
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>requests are verified correctly by the server.
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>&lt;a id=&quot;fig-3&quot;/&gt;
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>```mermaid
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>sequenceDiagram
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>autonumber
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>participant c as Charlie
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>participant s as Server
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>participant a as Alice
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>participant b as Bob
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>c-&gt;&gt;s: Channel join request + KeyPackage
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>s-&gt;&gt;s: Notify group of join request
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>s-&gt;&gt;a: Channel join request + c&#39;s KeyPackage
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>a-&gt;&gt;a: Verify c&#39;s KeyPackage
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>a-&gt;&gt;s: Notify group of new member: c
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>a-&gt;&gt;s: Encrypted MLS Welcome
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>s-&gt;&gt;b: Forward: Notify group of new member: c
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>s-&gt;&gt;c: Forward: Notify group of new member: c
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>s-&gt;&gt;c: Forward: encrypted MLS Welcome
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>\```
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>Fig. 3: Sequence diagram of a successful encrypted channel join in which Alice acts as a gatekeeper.
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>The sequence diagram assumes that Alice can verify Charlies&#39; public key to indeed belong to
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>Charlie, and that Alice accepts the join request.
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>### 3.2 Encrypted direct messages
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>Adding another person to a direct message is not possible, and would not make much sense, as the
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>new person cannot see any messages that were sent before they joined the group. If Alice wants
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>to add Charlie to a direct message with Bob, she will have to create a new direct message with
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>Bob and Charlie.
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>```mermaid
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>sequenceDiagram
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>autonumber
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>participant Alice
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>participant Server
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>participant Bob
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>Alice-&gt;&gt;Server: Request Bob&#39;s KeyPackages
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>Server-&gt;&gt;Alice: Bob&#39;s KeyPackages
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>Alice-&gt;&gt;Alice: Verify Bob&#39;s KeyPackages
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>Alice-&gt;&gt;Server: Notify group of new member: Bob
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>Server-&gt;&gt;Alice: Encrypted MLS Welcome
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>Server-&gt;&gt;Bob: Forward: New group member: Bob
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>Server-&gt;&gt;Bob: Forward encrypted MLS Welcome
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>\```
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>Fig. 4: Sequence diagram of a successful encrypted direct message creation.
<a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a>### 3.3 Encrypted group messages
<a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a>Encrypted group messages work by using the traditional MLS protocol, with the additional concept
<a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>of group owners. Only group owners can add new members to the group and forcibly remove others
<a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a>from the group. The Group owner is determined by the Client-Server API.
<a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>```mermaid
<a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>sequenceDiagram
<a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a>autonumber
<a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a>participant Alice as Alice (gatekeeper)
<a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a>participant Server
<a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a>participant Bob
<a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a>participant Charlie
<a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>Alice-&gt;&gt;Server: Request Bob&#39;s KeyPackages
<a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a>Server-&gt;&gt;Alice: Bob&#39;s KeyPackages
<a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a>Alice-&gt;&gt;Alice: Verify Bob&#39;s KeyPackages
<a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a>Alice-&gt;&gt;Server: Notify group of new member: Bob
<a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a>Server-&gt;&gt;Alice: Encrypted MLS Welcome
<a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a>Server-&gt;&gt;Bob: Forward: New group member: Bob
<a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a>Server-&gt;&gt;Bob: Forward encrypted MLS Welcome
<a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>Alice-&gt;&gt;Server: Request Charlie&#39;s KeyPackages
<a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>Server-&gt;&gt;Alice: Charlie&#39;s KeyPackages
<a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a>Alice-&gt;&gt;Alice: Verify Charlie&#39;s KeyPackages
<a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>Alice-&gt;&gt;Server: Notify group of new member: Charlie
<a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>Server-&gt;&gt;Alice: Encrypted MLS Welcome
<a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>Server-&gt;&gt;Bob: Forward: New group member: Charlie
<a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a>Server-&gt;&gt;Charlie: Forward: New group member: Charlie
<a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>Server-&gt;&gt;Charlie: Forward encrypted MLS Welcome
<a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>\```
<a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a>Fig. 5: Sequence diagram of a successful encrypted group creation with 3 members.
<a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>### 3.4 Joining new devices from existing users
<a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a>Regardless of channel or group permissions, a user join request from a new device should be
<a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a>accepted by default.
<a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a>### 3.5 Best practices
<a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a>- In case of encrypted guild channel join requests, it may be a good idea to treat multiple join
<a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a>  requests from the same user with different clients as a single join request, when it comes to UI/UX.
<a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a>- Joining an encrypted channel, even from an already established member with a new device,
<a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a>  should be an event distinctly visible to all members of the channel. This is to prevent a
<a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a>  malicious user from joining a channel without the other members noticing.
</code></pre></div>
<hr />
<h2 id="polyproto-chat-specific-glossary">polyproto-chat specific glossary<a class="headerlink" href="#polyproto-chat-specific-glossary" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Message group</strong> - A "guildless" message channel with 2-15 individual actors.</li>
<li><strong>Guild</strong> - Guilds are fundamental organizational units, representing a community or group of users
  who share a common interest, purpose or affiliation. Guilds are organized into channel categories,
  which contain channels. See also: <code>Channel</code>, <code>Channel Category</code>, <code>Role</code>, <code>Permission</code></li>
</ul>
<h2 id="general-glossary">General glossary<a class="headerlink" href="#general-glossary" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Actor</strong> - An entity represented by a federation ID, registered on a home server. Actors can be
  users, bots, or any other entity with a federation ID.</li>
<li><strong>CA, Certificate Authority</strong> - Any home server that issues and publicly attests to the validity
  of ID-Certs. In polyproto, only home servers are CAs.</li>
<li><strong>Client</strong> - Any application used by an actor to connect to an instance.</li>
<li><strong>CSR, Certificate Signing Request</strong> - A request sent to a CA to obtain a certificate. It holds
  information about the entity requesting the certificate, including their public identity key.</li>
<li><strong>DN, Distinguished Name</strong> - A set of RDNs (Relative Distinguished Names) that uniquely identify
  a certificate. See <a href="https://ldap.com/ldap-dns-and-rdns/">https://ldap.com/ldap-dns-and-rdns/</a></li>
<li><strong>Federation ID</strong> - A unique identifier; In public contexts, usually <strong>actor@</strong>subdomain.<strong>example</strong>.com,
  where bold parts are required and non-bold parts are optional.</li>
<li><strong>Foreign server</strong> - An instance that an actor is not registered on; essentially a third party.</li>
<li><strong>Gateway, Gateway Server</strong> - A polyproto compliant WebSocket server.</li>
<li><strong>Home server</strong> - The instance that an actor is registered on. Any polyproto-core compliant server
  hosted on the same domain is also considered a home server. A home server is the instance that
  publicly attests to the validity of all legitimate ID-Certs issued under its <a href="https://en.wikipedia.org/wiki/Fully_qualified_domain_name">FQDN</a>.
  A domain can have many home servers, but only one per subdomain.</li>
<li><strong>ID-CSR</strong> - A certificate signing request for a client's identity key pair. It is used to obtain
  an ID-Cert.</li>
<li><strong>Identity</strong> - Synonymous with "Federation ID".</li>
<li><strong>Identity Key Pair</strong> - A key pair associating an identity with a set of cryptographic keys used
  to sign and possibly encrypt messages.</li>
<li><strong>Instance</strong> - A server hosting polyproto compliant software for clients.</li>
<li>
<p><strong>Message, Messages</strong>: In the context of this protocol specification, a <strong>message</strong> is any piece
  of data sent by a client that is intended to be identifiable as being sent by a specific actor.
  To qualify as a "message", this piece of data must also, at any point in time, and also if only
  briefly, be visible to other users or to the unauthenticated public. Examples of things that would
  qualify as messages include:</p>
<ul>
<li>A message sent to another actor in a chat application</li>
<li>A post on a social media platform</li>
<li>A "like" interaction on a social media platform</li>
<li>Reaction emojis in Discord-like chat applications</li>
<li>Group join or leave messages</li>
<li>Reporting a post or actor, if the report is not anonymous</li>
</ul>
</li>
<li>
<p><strong>P2</strong> - Shortened form of polyproto.</p>
</li>
<li><strong>P2 Extension</strong> - A polyproto extension.</li>
<li><strong>polyproto-chat</strong> - The chat-API used by Polyphony. An extension of the polyproto protocol,
  defining the routes and capabilities of the chat-API used by Polyphony.</li>
<li><strong>polyproto</strong> - The core federation protocol and APIs of polyproto, enabling identification and
  authorization on foreign servers. It is independent of the chat-API used.</li>
<li><strong>RawR</strong> - <a href="/Protocol%20Specifications/core#731-resource-addressing-with-relative-roots">Resource addressing with relative roots</a>.</li>
<li><strong>Root Certificate</strong> - A certificate used to sign other certificates, establishing a chain of
  trust. In polyproto, only home servers have root certificates.</li>
<li><strong>Service</strong>: Any application-specific implementation of polyproto, defined by a P2 extension.
  All services are P2 extensions, but not all P2 extensions are services. polyproto-chat is an
  example of a service.</li>
<li><strong>Session</strong> - A specific period of authenticated interaction between a client and an instance.
  During the lifetime of a session, the client can perform actions as the actor they are authenticated
  as.</li>
<li><strong>Session ID</strong> - <a href="/Protocol%20Specifications/core#6113-session-ids">See polyproto specification: Section 6.1.1.3</a></li>
</ul>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="March 14, 2025 19:59:18"><span class="timeago" datetime="2025-03-14T19:59:18+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="March 14, 2025 19:59:18">2025-03-14</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="December 23, 2023 17:48:43"><span class="timeago" datetime="2023-12-23T17:48:43+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="December 23, 2023 17:48:43">2023-12-23</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "toc.follow", "navigation.top", "search.suggest", "content.tooltips", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../assets/external/unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>